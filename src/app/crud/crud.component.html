<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12">
            <div class="bread-crumb">
                <h3 title="Students List">Students List</h3>
                <button class="btn btn-primary add-btn" (click)="open(content)" title="Add New Student">
                    <img src="../../assets/images/plus.svg" />Add New Student
                </button>
            </div>
            <div class="table-div">
                <table class="table table-hover table-striped table-bordered">
                    <thead>
                        <tr>
                            <th title="ID">ID</th>
                            <th title="Name">Name</th>
                            <th title="Email">Email</th>
                            <th title="Gender">Gender</th>
                            <th [width]="128" title="Actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let i of users">
                            <td>{{ i.id }}</td>
                            <td>{{ i.name }}</td>
                            <td>{{ i.email }}</td>
                            <td>{{ i.gender }}</td>
                            <td>
                                <button class="btn btn-primary" (click)="editUser(i, content)" title="Edit">
                                    <img src="../../assets/images/pencil.svg" width="15" />
                                </button>
                                <button class="btn btn-red" (click)="deleteUser(i.id)" title="Delete">
                                    <img src="../../assets/images/trash.svg" width="15" />
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <ng-template #content let-modal>
                    <div class="modal-header">
                        <h4 class="modal-title" id="modal-basic-title">{{selectedUser? "Edit Student": "New Student"}}</h4>
                        <button type="button" class="close" aria-label="Close" (click)="close(modal)">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <!-- Simple Form -->
                        <form [formGroup]="userForm" (ngSubmit)="onSubmit()" novalidate>
                            <div class="form-group">
                                <label for="name">Name</label>
                                <div class="input-group">
                                    <input name="name" class="form-control" *ngIf="selectedUser?" [(ngModel)]="selectedUser.name" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="email">Email: <span class="required">*</span></label>
                                <div class="input-group">
                                    <input formControlName="email" 
                                        type="email" placeholder="name@example.com" name="email"
                                        [class.error]="get('email')?.invalid && get('email')?.touched"
                                        [class.valid]="get('email')?.valid && get('email')?.touched">
                                </div>
                                <div class="msj-error" *ngIf="get(email)?.invalid && get(email)?.touched">
                                    <small *ngIf="get(email)?.hasError('required')" class="error">Email is required</small>
                                    <small *ngIf="get('email')?.hasError('email')" class="error">Invalid email format</small>
                                </div>
                            </div>
                            <div>
                                <label for="gender">Gender: <span class="required">*</span></label>
                                <div>
                                    <input type="radio" value="male" 
                                        name="gender" 
                                        [class.error]="get('gender')?.invalid && get('gender')?.touched"
                                        [class.valid]="get('gender')?.valid && get('gender')?.touched"
                                        [(ngModel)]="selectedUser.gender"> Male
                                    <input type="radio" value="female"
                                        name="gender" 
                                        [class.error]="get('gender')?.invalid && get('gender')?.touched"
                                        [class.valid]="get('gender')?.valid && get('gender')?.touched"
                                        [(ngModel)]="selectedUser.gender"> Female
                                </div>
                                <div class="msj-error" *ngIf="get('gender')?.invalid && get('gender')?.touched">
                                    <small *ngIf="get('gender')?.hasError('required')" class="error">
                                        Gender is required
                                    </small>
                                </div>  
                            </div>
                            <div class="button-group">
                                <button type="submit" 
                                [disabled]="registroForm.invalid || enviado" 
                                class="btn btn-primary">
                                <span *ngIf="enviado">Registering...</span>
                                <span *ngIf="!enviado">Register User</span>
                            </button>
                            <button
                                type="button"
                                (click)="registroForm.reset()"
                                class="btn btn-secondary"
                                [disabled]="enviado">
                                Clear
                            </button>
                            </div>
                        </form>
                        <!-- Form state -->
                        <div class="estado-form">
                            <p><strong>Form state:</strong>
                                <span [class]="registroForm.valid ? 'valid' : 'invalid">
                                    {{ registroForm.valid ? 'Valid': 'Invalid' }}
                                </span>
                            </p>
                            <details>
                                <summary>See actual values</summary>
                                <pre>{{ registroForm.value | json }}</pre>
                            </details>
                        </div>
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>